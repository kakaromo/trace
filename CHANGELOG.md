# 변경사항 로그 (2025년 7월 6일)

## 주요 변경사항

### 1. 자동 처리 모드 선택 기능 추가
- **파일**: `src/main.rs`
- **변경내용**:
  - `--highperf` 옵션 제거
  - `get_file_size()` 함수 추가: 파일 크기 확인
  - `determine_processing_mode()` 함수 추가: 파일 크기 기반 모드 결정
  - 1GB 이상 파일은 자동으로 고성능 모드, 1GB 미만은 스트리밍 모드
  - `--streaming` 옵션으로 수동 스트리밍 모드 강제 가능

### 2. Block Parquet 스키마 일관성 개선
- **파일**: `src/output/parquet.rs`
- **변경내용**:
  - `save_block_to_parquet()` 함수의 스키마를 `models/block.rs`와 완전히 일치
  - 누락된 필드 추가: `comm`, `qd`
  - 필드 매핑 정확성 향상: `sector` 필드 올바른 매핑
  - 모든 Block 구조체 필드가 Parquet 스키마에 포함

### 3. 성능 최적화
- **파일**: `src/output/parquet.rs`
- **변경내용**:
  - 병렬 처리를 통한 chunk 단위 데이터 처리
  - 사전 할당된 벡터 사용으로 메모리 효율성 향상
  - 순차적 파일 쓰기로 I/O 성능 최적화

## 영향 범위

### 사용자 인터페이스
- `--highperf` 옵션 제거로 CLI 인터페이스 단순화
- 파일 크기 기반 자동 모드 선택으로 사용 편의성 향상
- `--streaming` 옵션 추가로 수동 제어 가능

### 데이터 일관성
- Block 데이터 Parquet 저장 시 모델 정의와 완전히 일치
- 기존 Parquet 파일 호환성 문제 해결 (새로운 파일 생성 필요)

### 성능
- 대용량 파일 처리 시 자동으로 최적 모드 선택
- Parquet 저장 성능 향상

## 호환성 주의사항

### 기존 Parquet 파일
- 이전 버전에서 생성된 Block Parquet 파일은 스키마 불일치로 읽기 오류 발생 가능
- 새로운 버전으로 재생성 필요

### CLI 인터페이스
- `--highperf` 옵션 사용 시 오류 발생 (제거됨)
- 자동 모드 선택으로 대부분의 경우 옵션 지정 불필요

## 테스트 결과

### 자동 모드 선택 테스트
- 소형 파일 (< 1GB): 스트리밍 모드 자동 선택 ✓
- 대형 파일 (≥ 1GB): 고성능 모드 자동 선택 ✓
- `--streaming` 옵션: 강제 스트리밍 모드 ✓

### Block Parquet 스키마 테스트
- 모든 Block 구조체 필드 포함 확인 ✓
- 데이터 타입 정확성 확인 ✓
- 필드 순서 일관성 확인 ✓

## 향후 계획

### 단기 목표
- 기존 Parquet 파일 마이그레이션 도구 개발
- 추가 성능 최적화 (압축 알고리즘 개선)

### 장기 목표
- 실시간 로그 분석 기능 추가
- 웹 기반 대시보드 개발
